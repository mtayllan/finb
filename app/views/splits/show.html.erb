<div class="w-full">
  <%= render UI::H1.new.with_content('Split Details') %>

  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <div class="flex justify-between items-start">
        <div class="flex-1">
          <h2 class="card-title text-2xl"><%= @split.source_transaction.description %></h2>
          <p class="text-gray-500"><%= @split.source_transaction.date.strftime('%B %d, %Y') %></p>
        </div>
        <div class="text-right">
          <div class="text-3xl font-bold"><%= number_to_currency(@split.amount_owed) %></div>
          <% if @split.paid? %>
            <div class="badge badge-success gap-2 mt-2">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-4 h-4 stroke-current">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Paid on <%= @split.paid_at.strftime('%b %d, %Y') %>
            </div>
          <% else %>
            <div class="badge badge-warning gap-2 mt-2">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-4 h-4 stroke-current">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              Pending Payment
            </div>
          <% end %>
        </div>
      </div>

      <div class="divider"></div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-4">
          <div>
            <h3 class="font-semibold text-lg">Payer</h3>
            <div class="flex items-center space-x-3 mt-2">
              <div class="avatar placeholder">
                <div class="bg-neutral-focus text-neutral-content rounded-full w-12">
                  <span class="text-lg"><%= @split.payer.username.first.upcase %></span>
                </div>
              </div>
              <div>
                <div class="font-medium"><%= @split.payer.username %></div>
                <div class="text-sm text-gray-500">Paid the transaction</div>
              </div>
            </div>
          </div>

          <div>
            <h3 class="font-semibold text-lg">Transaction Details</h3>
            <div class="mt-2 space-y-2">
              <div class="flex justify-between">
                <span class="text-gray-600">Original Amount:</span>
                <span class="font-medium"><%= number_to_currency(@split.source_transaction.value.abs) %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Account:</span>
                <span class="font-medium"><%= @split.source_transaction.account.name %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Category:</span>
                <span class="font-medium"><%= @split.source_transaction.category.name %></span>
              </div>
            </div>
          </div>
        </div>

        <div class="space-y-4">
          <div>
            <h3 class="font-semibold text-lg">Owes To</h3>
            <div class="flex items-center space-x-3 mt-2">
              <div class="avatar placeholder">
                <div class="bg-primary text-primary-content rounded-full w-12">
                  <span class="text-lg"><%= @split.owes_to.username.first.upcase %></span>
                </div>
              </div>
              <div>
                <div class="font-medium"><%= @split.owes_to.username %></div>
                <div class="text-sm text-gray-500">Owes <%= number_to_currency(@split.amount_owed) %></div>
              </div>
            </div>
          </div>

          <% if @split.owes_to_category %>
            <div>
              <h3 class="font-semibold text-lg">Category for <%= @split.owes_to.username %></h3>
              <div class="mt-2">
                <span class="badge badge-outline"><%= @split.owes_to_category.name %></span>
              </div>
            </div>
          <% end %>
        </div>
      </div>

      <div class="card-actions justify-end mt-6">
        <% unless @split.paid? %>
          <%= button_to "Mark as Paid", mark_as_paid_split_path(@split), method: :patch, class: "btn btn-success" %>
        <% end %>
        <%= link_to "Edit", edit_split_path(@split), class: "btn btn-outline" %>
        <%= link_to "Back to Splits", splits_path, class: "btn btn-primary" %>
      </div>
    </div>
  </div>
</div>
